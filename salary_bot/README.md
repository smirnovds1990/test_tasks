# Salary Bot
Приложение для получения агрегированных данных по зарплате за различные периоды времени.

___

## ТЗ
Задачей в рамках этого тестового задания будет написание алгоритма агрегации статистических данных о зарплатах сотрудников компании по временным промежуткам. Тестовые данные находятся в корневой директории проекта в директории `dump`.
Алгоритм должен принимать на вход:
- Дату и время старта агрегации в ISO формате (далее dt_from)
- Дату и время окончания агрегации в ISO формате (далее dt_upto)
- Тип агрегации (далее group_type). Типы агрегации могут быть следующие: hour, day, month. То есть группировка всех данных за час, день, неделю, месяц.

Пример входных данных:
```json
{
    "dt_from":"2022-09-01T00:00:00",
    "dt_upto":"2022-12-31T23:59:00",
    "group_type":"month"
}
```
***Комментарий к входным данным:** необходимо агрегировать выплаты с 1 сентября 2022 года по 31 декабря 2022 года, тип агрегации по месяцу*

На выходе алгоритм формирует ответ содержащий:
- Агрегированный массив данных (далее dataset)
- Подписи к значениям агрегированного массива данных в ISO формате (далее labels)

Пример ответа:
```json
{
    "dataset": [5906586, 5515874, 5889803, 6092634],
    "labels": ["2022-09-01T00:00:00", "2022-10-01T00:00:00", "2022-11-01T00:00:00", "2022-12-01T00:00:00"]
}
```
***Комментарий к ответу:** в нулевом элементе датасета содержится сумма всех выплат за сентябрь, в первом элементе сумма всех выплат за октябрь и т.д. В лейблах подписи соответственно элементам датасета.*

___
Технологии:
- [Python](https://www.python.org/)
- [MongoDB](https://www.mongodb.com/)
- [aiogram](https://aiogram.dev/)

### Использование

```sh
git clone https://github.com/smirnovds1990/test_tasks.git
cd test_tasks/salary_bot
python -m venv venv
source venv/bin/activate (Windows - source venv/Scripts/activate)
pip install -r requirements.txt
# Создать телеграм бота
Написать боту - @BotFather, следовать инструкциям по созданию
# Установить MongoDB следуя документации для вашей ОС
https://www.mongodb.com/docs/manual/installation/
# Загрузить данные в БД
mongorestore --db database_name --collection collection_name dump/sample_collection.bson
Создать .env-файл в корневой директории приложения (salary_bot/)
# Добавить нужные переменные в .env-файл (смотреть .env.example)
# Установить в файле create_bot.py переменную db в соответствии с названием вашей базы данных и коллекции в ней
db = client.database_name.collection_name
python run_bot.py
# Перейти в своего телеграм бота, нажать Start
```